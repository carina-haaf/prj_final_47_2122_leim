%%________________________________________________________________________
%% LEIM | PROJETO
%% 2022 / 2013 / 2012
%% Modelo para relatório
%% v04: alteração ADEETC para DEETC; outros ajustes
%% v03: correção de gralhas
%% v02: inclui anexo sobre utilização sistema controlo de versões
%% v01: original
%% PTS / MAR.2022 / MAI.2013 / 23.MAI.2012 (construído)
%%________________________________________________________________________


%%________________________________________________________________________
\chapter{Implementação do Modelo}
\label{ch:implementacaoDoModelo}
%%________________________________________________________________________

Este capítulo descreve todo o processo de implementação das etapas enunciadas na secção abordagem (\ref{sec:abordagem}).

%%________________________________________________________________________
\section{Construção do \textit{Dataset}}
\label{sec:construcaodatasetv2}
%%________________________________________________________________________

O processo de criação do \textit{dataset} pode ser representado pelo esquema que se encontra na figura \ref{fig:construcaodatasetdetalhe}. 

%%À exceção da fase de anotação manual das batidas de bola (\aspas{\textit{Human ear annotation}}), todas as outras fases do esquema foram realizadas no ambiente de desenvolvimento \textit{Pycharm} que compila e executa código \textit{Python} \cite{jetbrains_pycharm_2022}.
 
Para simplificar o processo de anotação das batidas de bola (\aspas{\textit{Human ear annotation}}), optou-se por segmentar o vídeo de longa duração em vídeos com 1 minuto. O processo de segmentação deu origem a cerca de 90 vídeos de curta duração. Para cada um desses vídeos, foram gerados os áudios correspondentes e 30 foram anotados.

A anotação das batidas de bola foi realizada com o auxílio da aplicação \textit{Adobe Audition} \cite{adobe2013adobe}. Esta ferramenta permite efetuar uma análise sobre áudio e verificar em que instantes ocorrem batidas de bola. A anotação é realizada num ficheiro \textit{Excel}, que posteriormente é convertido para \textit{CSV}.

Cada evento está registado no ficheiro \textit{Excel} com os seguintes dados:

\begin{itemize}
\item
O tipo de batida de bola (em raquete, no chão, na rede metálica, entre outros). Todos estes tipos pertencem à classe batida de bola, no entato apenas as batidas de bola em raquete foram consideradas neste projeto;

\item
O intervalo de tempo em que ocorre a batida de bola (amostras inicial e final no áudio);

\item
O tipo de ambiente em que o treino é praticado (\textit{indoor} ou \textit{outdoor});

\item
O lado do campo em que batida de bola ocorre.

\end{itemize}

O tipo de ambiente onde o desporto é praticado e o lado do campo onde ocorrem as batidas de bola estão fora do contexto do presente trabalho.

Na fase de extração de características iterou-se apenas sobre os áudios anotados. Sobre estes áudios realizou-se o processo descrito na secção \ref{sec:construcaododataset} para obtenção da matriz de características com o auxílio da biblioteca \textit{tensorflow}. Esta biblioteca permite realizar  indexação e varrimento sobre \textit{arrays} de forma simples.

Na fase de \aspas{\textit{Labeling}} combinou-se a informação registada nos ficheiros \textit{CSV} (batidas de bola) com as características tal como se verifica na figura  \ref{fig:matrizfeaturesv2}, o que permitiu obter o \textit{dataset} a utilizar na contrução do modelo (\aspas{\textit{Input data}}). %Este processo de etiquetação foi realizado com base na equação \ref{eq:formulan}.

\begin{figure}[h]
   \centering
   \includegraphics[width=14cm]{./construct_dataset_scheme}
\caption{Processo detalhado de construção do \textit{dataset}.}
\label{fig:construcaodatasetdetalhe}
\end{figure}

Considerou-se como primeira abordagem a primeira linha da tabela \ref{tab:tabelaparamformuladen}, onde a cada iteração a janela desliza 1024 amostras e abranje 22 grupos de 1024 amostras (0.5 segundos). O \textit{dataset} obtido contém cerca de 75 mil exemplos: 19724 exemplos de batidas de bola e 54646 exemplos de ruído.

%%________________________________________________________________________
\section{Construção do Classificador}
\label{sec:sec:construcaodoclassificadorv2}
%%________________________________________________________________________

A construção do modelo pode ser descrita através da figura \ref{fig:construcaoclassif}, que descreve de uma forma geral as fases envolvidas neste processo. 

\begin{figure}
   \centering
   \includegraphics[width=12cm]{./model_construction_scheme_v4}
\caption{Processo de construção do classificador.}
\label{fig:construcaoclassif}
\end{figure}

\bigskip
\paragraph{\textbf{Escolha do modelo}} \hspace{0pt}

\smallskip
\smallskip
\smallskip
\noindent Através da ferramenta ODM aplicaram-se vários algoritmos ao \textit{dataset} e obtiveram-se os resultados que se encontram na figura \ref{fig:odmresults}. %Antes do processo de treino, à exceção da árvore de decisão, os dados de \textit{input} são pré-processados. No caso da rede neuronal, é utilizado o algoritmo \textit{Standard Scaler} de modo que as dimensões da matriz de características tenham média zero e variância igual a 1 \cite{orange3_2022_neuralnetwork}. 
Estes resultados (independentes das classes) sugerem que os modelos com melhores desemepenhos são o regressor logístico e a rede neuronal. Para estes dois classificadores os valores das métricas de avaliação (\cf, \ref{sec:classifevalidacaocruzada}) estão acima dos 85\% e o erro (\aspas{\textit{LogLoss}}) associado à classificação é igual ou inferior 34\%.

As figuras \ref{fig:odm_results_positives} e \ref{fig:odm_results_negatives} correspondem aos resultados para cada uma das classes (positivos e negativos). Observando separadamente estes resultados, verifica-se que a rede neuronal obtém os melhores resultados em termos de taxa de sucesso, média harmónica e erro associado. Por este motivo, a rede neuronal será a técnica de aprendizagem automática a utilizar para construir o classificador.

%Devido ao desequilíbrio no \textit{dataset}, os valores obtidos no caso da classe dos positivos (batidas de bola) são menos eficientes. Como solução, será aplicada a técnica de sub-amostragem na qual se diminui o número de exemplos da classe dos negativos (ruído).

%%O regressor logístico pode ser \aspas{visto} como uma rede neuronal com apenas uma camada escondida \cite{datasciencecentral_lrnn_2019}. Pelo que neste trabalho será utilizada a rede neuronal como método de aprendizagem automática.

\begin{figure}[h]
   \centering
   \includegraphics[width=11cm]{./odm_results_v2}
\caption{Resultados (independentes das classes) da aplicação de vários algoritmos aos dados.}
\label{fig:odmresults}
\end{figure}

De forma obter resultados próximos dos observados para a rede neuronal serão considerados os hiper-parâmetros utilizados na aplicação ODM.

\paragraph{\textbf{Definição dos Hiper-parâmetros e Treino do Modelo}} \hspace{0pt}

\smallskip
\smallskip
\smallskip
\noindent Para construir e treinar o modelo utilizou-se a biblioteca \textit{Python Keras}. Esta biblioteca usa internamente o módulo \textit{tensorflow} e permite criar modelos de aprendizagem automática de forma simples e flexível \cite{keras_aboutkeras_2022}. 

A capacidade de generalizar do modelo foi verificada através do método de validação cruzada, \textit{Stratified KFold}. Tal como na ferramenta ODM, os dados foram divididos em 5 \textit{folds}.

Os hiper-parâmetros considerados foram os seguintes:

\begin{itemize}
\item
Temporais -- duração da janela de dimensão fixa (\textit{eventLength}) e número de amostras deslizadas a cada iteração (\textit{hopLength});

\item
Na rede neuronal -- tipo de regularização e o parâmetro \textit{lambda} associado, taxa de aprendizagem, método de otimização, número de épocas, número de \textit{batches}, número de camadas na rede e de neurónios em cada camada.

\end{itemize}

Os parâmetros temporais têm influência na estrutura do \textit{dataset} por isso também têm impacto na construção do modelo. Os parâmetros da rede neuronal têm impacto na forma como o modelo se ajusta aos dados recebidos.

O objetivo é escolher os hiper-parâmetros do modelo que produzem os melhores resultados. Para esse efeito, após a verificação dos resultados obtidos no treino e validação, os hiper-parâmetros foram ajustados várias vezes, no sentido de melhorar a qualidade do modelo.

%%________________________________________________________________________
\section{Desenvolvimento da Aplicação \textit{web}}
\label{sec:criacaodaappv2}
%%________________________________________________________________________

Os \textit{clips} constituintes de cada vídeo de teste, bem como todas as informações a eles associadas (eventos em análise, tempos iniciais e finais de cada evento, probabilidade de um evento ser batida de bola, entre outras) foram organizados numa diretoria através de código \textit{Python}. Essa diretoria é posteriormente copiada para a aplicação desenvolvida em PHP. 

A aplicação \textit{web} obtém e processa as informações contidas na diretoria e mostra os resultados ao utilizador. O esquema da figura \ref{fig:webappconstructionprocess} descreve o processo de desenvolvimento da aplicação \textit{web}.


\begin{figure}[h]
   \centering
   \includegraphics[width=12cm]{./web_app_construction_scheme}
\caption{Processo de desenvolvimento da applicação \textit{web}.}
\label{fig:webappconstructionprocess}
\end{figure}

A figura \ref{fig:organizacaodaappweb} representa a estrutura da aplicação.
A diretoria \aspas{\textit{Lib}} contém as constantes, métodos auxiliares (em \aspas{\textit{jsScripts.js}} e \aspas{\textit{styles.css}}) e uma folha de estilos (CSS). A diretoria \aspas{\textit{videos}} recebe outras diretorias que contém informação sobre vídeos classificados. As páginas PHP abaixo permitem apresentar os resultados ao utilizador.

\begin{figure}[h]
   \centering
   \includegraphics[width=5cm]{./app_web_project_sctruture}
\caption{Estrututa do projeto correspondente à aplicação \textit{web} no IDE Netbeans.}
\label{fig:organizacaodaappweb}
\end{figure}


%%________________________________________________________________________
\chapter{Validação e Testes}
\label{ch:validacaoTestes}
%%________________________________________________________________________

Neste capítulo serão apresentados os resultados obtidos ao longo do processo de construção do modelo final a ser utilizado para a classificação de batidas de bola.

%%________________________________________________________________________
\section{Definição dos Hiper-parâmetros}
\label{sec:defhiperparms}
%%________________________________________________________________________

Para obter um modelo que identifique corretamente batidas de bola em raquete foram realizados vários experimentos, alterando os parâmetros da rede neuronal. As tabelas \ref{tab:tests_1} e \ref{tab:tests_2} contém os resultados obtidos para esses experimentos. Considerou-se um número de \textit{batches} igual a 128, a função de erro \textit{binary cross-entropy}, o algoritmo de optimização \textit{Adam} e um parâmetro \textit{eventLength} igual a 0.5 segundos. Todos os outros hiper-parâmetros encontram-se evidenciados nas tabelas referidas.

A duração dos eventos (\textit{eventLength}) foi pré-definida para meio segundo, por isso, o valor de N e, consequentemente, o número de exemplos no \textit{dataset} em (\aspas{\textit{Dataset Observations}}) dependem do valor de (\aspas{\textit{Hop}}) de acordo com a expressão \ref{eq:formulan}. Cada um dos experimentos (1 a 12) foi realizado dividindo os dados em 5 \textit{folds} através da técnica \textit{Stratified KFold}. Pelo que cada um desses experimentos dá origem a 5 modelos diferentes. Os resultados presentes na tabela \ref{tab:tests_2} constituem os valores médios obtidos dos 5 modelos construídos. 

%Observando os valores presentes na tabela \ref{tab:tests_2} verifica-se que os valores médios obtidos nas fases de treino e os validação estão bastante próximos. Os valores obtidos para os conjuntos de validação permitem obter uma estimativa de como o classificador se comporta ao observar dados novos, mas não eliminam a possibilidade de estar a ocorrer sobre-aprendizagem.

Os experimentos 1 e 2 foram realizados com os mesmos hiper-parâmetros da rede neuronal, mas com \textit{datasets} diferentes (desequilibrado e equilibrado, respetivamente). Os valores de accuracy e loss estão bastante próximos para os conjuntos de treino e validação. No entanto, no caso do dataset desequilibrado os resultados são 
 

%=======================================================================
%=======================================================================
%=======================================================================
\begin{table}[h]
\begin{center}

\resizebox{14cm}{!}{% permite fazer


\begin{tabular}{|c|c|c|cc|ccc|c|cccc|}
\hline
\multirow{3}{*}{Experiment} & \multirow{3}{*}{Hop}  & \multirow{3}{*}{Layers} & \multicolumn{2}{c|}{Neurons}                                                                                                                                          & \multicolumn{3}{c|}{Regularization}                                                                                & \multirow{3}{*}{Epochs} & \multicolumn{4}{c|}{Dataset Observations}                                                                                                                          \\ \cline{4-8} \cline{10-13} 
                            &                       &                         & \multicolumn{1}{c|}{\multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}1st \\ Layer\end{tabular}}} & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Hidden\\ Layers\end{tabular}} & \multicolumn{1}{c|}{\multirow{2}{*}{Dropout}} & \multicolumn{1}{c|}{\multirow{2}{*}{L1}}   & \multirow{2}{*}{L2}   &                         & \multicolumn{2}{c|}{Train}                                                                  & \multicolumn{2}{c|}{Validation}                                      \\ \cline{10-13} 
                            &                       &                         & \multicolumn{1}{c|}{}                                                                      &                                                                          & \multicolumn{1}{c|}{}                         & \multicolumn{1}{c|}{}                      &                       &                         & \multicolumn{1}{c|}{Ball Hits}               & \multicolumn{1}{c|}{Noise}                   & \multicolumn{1}{c|}{Ball Hits}              & Noise                  \\ \hline
\multirow{2}{*}{1}          & \multirow{2}{*}{1024} & \multirow{2}{*}{4}      & \multicolumn{1}{c|}{\multirow{2}{*}{66}}                                                   & 64                                                                       & \multicolumn{1}{c|}{0.4}                      & \multicolumn{1}{c|}{\multirow{2}{*}{10-3}} & \multirow{2}{*}{10-3} & \multirow{2}{*}{100}    & \multicolumn{1}{c|}{\multirow{2}{*}{15780}}  & \multicolumn{1}{c|}{\multirow{2}{*}{43716}}  & \multicolumn{1}{c|}{\multirow{2}{*}{3944}}  & \multirow{2}{*}{10930} \\ \cline{5-6}
                            &                       &                         & \multicolumn{1}{c|}{}                                                                      & 32                                                                       & \multicolumn{1}{c|}{0.2}                      & \multicolumn{1}{c|}{}                      &                       &                         & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                       &                        \\ \hline
\multirow{2}{*}{2}          & \multirow{2}{*}{1024} & \multirow{2}{*}{4}      & \multicolumn{1}{c|}{\multirow{2}{*}{66}}                                                   & 64                                                                       & \multicolumn{1}{c|}{0.4}                      & \multicolumn{1}{c|}{\multirow{2}{*}{10-3}} & \multirow{2}{*}{10-3} & \multirow{2}{*}{100}    & \multicolumn{1}{c|}{\multirow{2}{*}{12653}}  & \multicolumn{1}{c|}{\multirow{2}{*}{12739}}  & \multicolumn{1}{c|}{\multirow{2}{*}{3163}}  & \multirow{2}{*}{3185}  \\ \cline{5-6}
                            &                       &                         & \multicolumn{1}{c|}{}                                                                      & 32                                                                       & \multicolumn{1}{c|}{0.2}                      & \multicolumn{1}{c|}{}                      &                       &                         & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                       &                        \\ \hline
3                           & 2048                  & 3                       & \multicolumn{1}{c|}{33}                                                                    & 256                                                                      & \multicolumn{1}{c|}{0.45}                     & \multicolumn{1}{c|}{N/A}                   & 10-5                  & 100                     & \multicolumn{1}{c|}{6328}                    & \multicolumn{1}{c|}{6367}                    & \multicolumn{1}{c|}{1582}                   & 1592                   \\ \hline
4                           & 2048                  & 3                       & \multicolumn{1}{c|}{33}                                                                    & 256                                                                      & \multicolumn{1}{c|}{0.45}                     & \multicolumn{1}{c|}{N/A}                   & 10-5                  & 300                     & \multicolumn{1}{c|}{7897}                    & \multicolumn{1}{c|}{21863}                   & \multicolumn{1}{c|}{1974}                   & 5466                   \\ \hline
5                           & 2048                  & 3                       & \multicolumn{1}{c|}{33}                                                                    & 256                                                                      & \multicolumn{1}{c|}{0.45}                     & \multicolumn{1}{c|}{N/A}                   & 10-5                  & 300                     & \multicolumn{1}{c|}{6328}                    & \multicolumn{1}{c|}{6367}                    & \multicolumn{1}{c|}{1582}                   & 1592                   \\ \hline
\multirow{2}{*}{6}          & \multirow{2}{*}{4096} & \multirow{2}{*}{4}      & \multicolumn{1}{c|}{\multirow{2}{*}{15}}                                                   & 32                                                                       & \multicolumn{1}{c|}{0.4}                      & \multicolumn{1}{c|}{\multirow{2}{*}{N/A}}  & \multirow{2}{*}{10-5} & \multirow{2}{*}{300}    & \multicolumn{1}{c|}{\multirow{2}{*}{3068}}   & \multicolumn{1}{c|}{\multirow{2}{*}{3213}}   & \multicolumn{1}{c|}{\multirow{2}{*}{767}}   & \multirow{2}{*}{804}   \\ \cline{5-6}
                            &                       &                         & \multicolumn{1}{c|}{}                                                                      & 16                                                                       & \multicolumn{1}{c|}{0.2}                      & \multicolumn{1}{c|}{}                      &                       &                         & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                       &                        \\ \hline
7                           & 4096                  & 3                       & \multicolumn{1}{c|}{15}                                                                    & 64                                                                       & \multicolumn{1}{c|}{0.4}                      & \multicolumn{1}{c|}{N/A}                   & 10-4                  & 200                     & \multicolumn{1}{c|}{3068}                    & \multicolumn{1}{c|}{3213}                    & \multicolumn{1}{c|}{767}                    & 804                    \\ \hline
8                           & 4096                  & 3                       & \multicolumn{1}{c|}{15}                                                                    & 64                                                                       & \multicolumn{1}{c|}{0.4}                      & \multicolumn{1}{c|}{N/A}                   & 10-4                  & 200                     & \multicolumn{1}{c|}{11076}                   & \multicolumn{1}{c|}{3828}                    & \multicolumn{1}{c|}{958}                    & 2768                   \\ \hline
9                           & 1024                  & 3                       & \multicolumn{1}{c|}{66}                                                                    & 64                                                                       & \multicolumn{1}{c|}{0.4}                      & \multicolumn{1}{c|}{N/A}                   & 10-6                  & 200                     & \multicolumn{1}{c|}{\multirow{2}{*}{12653}}  & \multicolumn{1}{c|}{\multirow{2}{*}{12739}}  & \multicolumn{1}{c|}{\multirow{2}{*}{3163}}  & \multirow{2}{*}{3185}  \\ \cline{1-9}
10                          & 1024                  & 3                       & \multicolumn{1}{c|}{66}                                                                    & 64                                                                       & \multicolumn{1}{c|}{0.4}                      & \multicolumn{1}{c|}{N/A}                   & N/A                   & 200                     & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                       &                        \\ \hline
11                          & 2048                  & 3                       & \multicolumn{1}{c|}{33}                                                                    & 64                                                                       & \multicolumn{1}{c|}{0.4}                      & \multicolumn{1}{c|}{N/A}                   & N/A                   & 200                     & \multicolumn{1}{c|}{6328}                    & \multicolumn{1}{c|}{6367}                    & \multicolumn{1}{c|}{1582}                   & 1592                   \\ \hline
12                          & 4096                  & 3                       & \multicolumn{1}{c|}{15}                                                                    & 64                                                                       & \multicolumn{1}{c|}{0.4}                      & \multicolumn{1}{c|}{N/A}                   & N/A                   & 200                     & \multicolumn{1}{c|}{3068}                    & \multicolumn{1}{c|}{3213}                    & \multicolumn{1}{c|}{767}                    & 804                    \\ \hline
\multirow{2}{*}{13}         & \multirow{2}{*}{1024} & \multirow{2}{*}{4}      & \multicolumn{1}{c|}{\multirow{2}{*}{66}}                                                   & 64                                                                       & \multicolumn{1}{c|}{\multirow{2}{*}{N/A}}     & \multicolumn{1}{c|}{\multirow{2}{*}{10-2}} & \multirow{2}{*}{N/A}  & \multirow{2}{*}{200}    & \multicolumn{1}{c|}{\multirow{10}{*}{12653}} & \multicolumn{1}{c|}{\multirow{10}{*}{12739}} & \multicolumn{1}{c|}{\multirow{10}{*}{3163}} & \multirow{10}{*}{3185} \\ \cline{5-5}
                            &                       &                         & \multicolumn{1}{c|}{}                                                                      & 32                                                                       & \multicolumn{1}{c|}{}                         & \multicolumn{1}{c|}{}                      &                       &                         & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                       &                        \\ \cline{1-9}
\multirow{2}{*}{14}         & \multirow{2}{*}{1024} & \multirow{2}{*}{4}      & \multicolumn{1}{c|}{\multirow{2}{*}{66}}                                                   & 64                                                                       & \multicolumn{1}{c|}{\multirow{2}{*}{N/A}}     & \multicolumn{1}{c|}{\multirow{2}{*}{10-4}} & \multirow{2}{*}{N/A}  & \multirow{2}{*}{200}    & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                       &                        \\ \cline{5-5}
                            &                       &                         & \multicolumn{1}{c|}{}                                                                      & 32                                                                       & \multicolumn{1}{c|}{}                         & \multicolumn{1}{c|}{}                      &                       &                         & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                       &                        \\ \cline{1-9}
15                          & 1024                  & 3                       & \multicolumn{1}{c|}{66}                                                                    & 128                                                                      & \multicolumn{1}{c|}{N/A}                      & \multicolumn{1}{c|}{10-3}                  & 10-3                  & 200                     & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                       &                        \\ \cline{1-9}
\multirow{2}{*}{16}         & \multirow{2}{*}{1024} & \multirow{2}{*}{4}      & \multicolumn{1}{c|}{\multirow{2}{*}{66}}                                                   & 32                                                                       & \multicolumn{1}{c|}{\multirow{2}{*}{N/A}}     & \multicolumn{1}{c|}{\multirow{2}{*}{N/A}}  & \multirow{2}{*}{10-5} & \multirow{2}{*}{200}    & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                       &                        \\ \cline{5-5}
                            &                       &                         & \multicolumn{1}{c|}{}                                                                      & 32                                                                       & \multicolumn{1}{c|}{}                         & \multicolumn{1}{c|}{}                      &                       &                         & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                       &                        \\ \cline{1-9}
\multirow{2}{*}{17}         & \multirow{2}{*}{1024} & \multirow{2}{*}{3}      & \multicolumn{1}{c|}{\multirow{2}{*}{66}}                                                   & 128                                                                      & \multicolumn{1}{c|}{\multirow{2}{*}{N/A}}     & \multicolumn{1}{c|}{\multirow{2}{*}{N/A}}  & \multirow{2}{*}{10-5} & \multirow{2}{*}{200}    & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                       &                        \\ \cline{5-5}
                            &                       &                         & \multicolumn{1}{c|}{}                                                                      & 32                                                                       & \multicolumn{1}{c|}{}                         & \multicolumn{1}{c|}{}                      &                       &                         & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                       &                        \\ \cline{1-9}
18                          & 1024                  & 3                       & \multicolumn{1}{c|}{66}                                                                    & 64                                                                       & \multicolumn{1}{c|}{N/A}                      & \multicolumn{1}{c|}{N/A}                   & 10-5                  & 200                     & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                        & \multicolumn{1}{c|}{}                       &                        \\ \hline
\end{tabular}


}


		
\caption{Testes realizados.}
\label{tab:tests_1}
		
\end{center}
\end{table}	


%=======================================================================
%=======================================================================
%=======================================================================

\begin{table}[h]
\begin{center}

\resizebox{13cm}{!}{% permite fazer


\begin{tabular}{|c|c|cc|cc|c|}
\hline
\multirow{2}{*}{Experiment} & \multirow{2}{*}{Learning Rate} & \multicolumn{2}{c|}{Accuracy}           & \multicolumn{2}{c|}{Loss}               & \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Activation\\ Function\end{tabular}} \\ \cline{3-6}
                            &                                & \multicolumn{1}{c|}{Train} & Validation & \multicolumn{1}{c|}{Train} & Validation &                                                                                \\ \hline
1                           & \multirow{6}{*}{10-3}          & \multicolumn{1}{c|}{92\%}  & 92\%       & \multicolumn{1}{c|}{0.25}  & 0.24       & \multirow{18}{*}{sigmoid}                                                      \\ \cline{1-1} \cline{3-6}
2                           &                                & \multicolumn{1}{c|}{92\%}  & 93\%       & \multicolumn{1}{c|}{0.25}  & 0.23       &                                                                                \\ \cline{1-1} \cline{3-6}
3                           &                                & \multicolumn{1}{c|}{93\%}  & 92\%       & \multicolumn{1}{c|}{0.18}  & 0.21       &                                                                                \\ \cline{1-1} \cline{3-6}
4                           &                                & \multicolumn{1}{c|}{95\%}  & 94\%       & \multicolumn{1}{c|}{0.16}  & 0.18       &                                                                                \\ \cline{1-1} \cline{3-6}
5                           &                                & \multicolumn{1}{c|}{94\%}  & 92\%       & \multicolumn{1}{c|}{0.16}  & 0.22       &                                                                                \\ \cline{1-1} \cline{3-6}
6                           &                                & \multicolumn{1}{c|}{91\%}  & 90\%       & \multicolumn{1}{c|}{0.25}  & 0.26       &                                                                                \\ \cline{1-6}
7                           & \multirow{2}{*}{10-2}          & \multicolumn{1}{c|}{90\%}  & 90\%       & \multicolumn{1}{c|}{0.27}  & 0.28       &                                                                                \\ \cline{1-1} \cline{3-6}
8                           &                                & \multicolumn{1}{c|}{92\%}  & 93\%       & \multicolumn{1}{c|}{0.23}  & 0.22       &                                                                                \\ \cline{1-6}
9                           & 10-4                           & \multicolumn{1}{c|}{93\%}  & 93\%       & \multicolumn{1}{c|}{0.19}  & 0.19       &                                                                                \\ \cline{1-6}
10                          & \multirow{9}{*}{10-3}          & \multicolumn{1}{c|}{94\%}  & 93\%       & \multicolumn{1}{c|}{0.16}  & 0.18       &                                                                                \\ \cline{1-1} \cline{3-6}
11                          &                                & \multicolumn{1}{c|}{93\%}  & 92\%       & \multicolumn{1}{c|}{0.19}  & 0.21       &                                                                                \\ \cline{1-1} \cline{3-6}
12                          &                                & \multicolumn{1}{c|}{91\%}  & 90\%       & \multicolumn{1}{c|}{0.25}  & 0.26       &                                                                                \\ \cline{1-1} \cline{3-6}
13                          &                                & \multicolumn{1}{c|}{89\%}  & 89\%       & \multicolumn{1}{c|}{0.32}  & 0.32       &                                                                                \\ \cline{1-1} \cline{3-6}
14                          &                                & \multicolumn{1}{c|}{94\%}  & 93\%       & \multicolumn{1}{c|}{0.18}  & 0.22       &                                                                                \\ \cline{1-1} \cline{3-6}
15                          &                                & \multicolumn{1}{c|}{95\%}  & 93\%       & \multicolumn{1}{c|}{0.15}  & 0.22       &                                                                                \\ \cline{1-1} \cline{3-6}
16                          &                                & \multicolumn{1}{c|}{95\%}  & 93\%       & \multicolumn{1}{c|}{0.13}  & 0.21       &                                                                                \\ \cline{1-1} \cline{3-6}
17                          &                                & \multicolumn{1}{c|}{97\%}  & 93\%       & \multicolumn{1}{c|}{0.09}  & 0.25       &                                                                                \\ \cline{1-1} \cline{3-6}
18                          &                                & \multicolumn{1}{c|}{96\%}  & 93\%       & \multicolumn{1}{c|}{0.11}  & 0.23       &                                                                                \\ \hline
\end{tabular}

}

		
\caption{Testes realizados.}
\label{tab:tests_2}
		
\end{center}
\end{table}	

%=======================================================================
%=======================================================================
%=======================================================================

%%________________________________________________________________________
\section{Classificação de Vídeos Novos}
\label{sec:classifdevideosnovos}
%%________________________________________________________________________

Para verificar como o classificador se comporta ao analisar dados novos procedeu-se ao teste 

\begin{table}[h]
\begin{center}

\resizebox{13cm}{!}{% permite fazer


\begin{tabular}{|c|ccc|ccc|}
\hline
\multirow{2}{*}{Model} & \multicolumn{3}{c|}{Test Accuracy}                                           & \multicolumn{3}{c|}{Test Loss}                                               \\ \cline{2-7} 
                       & \multicolumn{1}{c|}{Video A 58} & \multicolumn{1}{c|}{Video B 4} & Video C 2 & \multicolumn{1}{c|}{Video A 58} & \multicolumn{1}{c|}{Video B 4} & Video C 2 \\ \hline
1                      & \multicolumn{1}{c|}{89\%}       & \multicolumn{1}{c|}{78\%}      & 59\%      & \multicolumn{1}{c|}{0.28}       & \multicolumn{1}{c|}{0.56}      & 1.78      \\ \hline
2                      & \multicolumn{1}{c|}{86\%}       & \multicolumn{1}{c|}{77\%}      & 69\%      & \multicolumn{1}{c|}{0.38}       & \multicolumn{1}{c|}{0.53}      & 1.37      \\ \hline
3                      & \multicolumn{1}{c|}{88\%}       & \multicolumn{1}{c|}{84\%}      & 67\%      & \multicolumn{1}{c|}{0.32}       & \multicolumn{1}{c|}{0.44}      & 1.11      \\ \hline
4                      & \multicolumn{1}{c|}{91\%}       & \multicolumn{1}{c|}{76\%}      & 58\%      & \multicolumn{1}{c|}{0.22}       & \multicolumn{1}{c|}{0.52}      & 2.16      \\ \hline
5                      & \multicolumn{1}{c|}{88\%}       & \multicolumn{1}{c|}{83\%}      & 69\%      & \multicolumn{1}{c|}{0.35}       & \multicolumn{1}{c|}{0.52}      & 1.35      \\ \hline
6                      & \multicolumn{1}{c|}{88\%}       & \multicolumn{1}{c|}{81\%}      & 58\%      & \multicolumn{1}{c|}{0.32}       & \multicolumn{1}{c|}{0.43}      & 1.16      \\ \hline
7                      & \multicolumn{1}{c|}{88\%}       & \multicolumn{1}{c|}{79\%}      & 67\%      & \multicolumn{1}{c|}{0.35}       & \multicolumn{1}{c|}{0.47}      & 1.16      \\ \hline
8                      & \multicolumn{1}{c|}{90\%}       & \multicolumn{1}{c|}{76\%}      & 61\%      & \multicolumn{1}{c|}{0.27}       & \multicolumn{1}{c|}{0.49}      & 1.50      \\ \hline
9                      & \multicolumn{1}{c|}{85\%}       & \multicolumn{1}{c|}{78\%}      & 64\%      & \multicolumn{1}{c|}{0.35}       & \multicolumn{1}{c|}{0.57}      & 1.40      \\ \hline
10                     & \multicolumn{1}{c|}{84\%}       & \multicolumn{1}{c|}{78\%}      & 72\%      & \multicolumn{1}{c|}{0.46}       & \multicolumn{1}{c|}{0.76}      & 1.57      \\ \hline
11                     & \multicolumn{1}{c|}{87\%}       & \multicolumn{1}{c|}{81\%}      & 67\%      & \multicolumn{1}{c|}{0.33}       & \multicolumn{1}{c|}{0.51}      & 1.22      \\ \hline
12                     & \multicolumn{1}{c|}{87\%}       & \multicolumn{1}{c|}{81\%}      & 66\%      & \multicolumn{1}{c|}{0.32}       & \multicolumn{1}{c|}{0.42}      & 1.17      \\ \hline
13                     & \multicolumn{1}{c|}{79\%}       & \multicolumn{1}{c|}{65\%}      & 49\%      & \multicolumn{1}{c|}{0.48}       & \multicolumn{1}{c|}{0.78}      & 1.77      \\ \hline
14                     & \multicolumn{1}{c|}{85\%}       & \multicolumn{1}{c|}{79\%}      & 68\%      & \multicolumn{1}{c|}{0.46}       & \multicolumn{1}{c|}{0.72}      & 1.64      \\ \hline
15                     & \multicolumn{1}{c|}{86\%}       & \multicolumn{1}{c|}{80\%}      & 64\%      & \multicolumn{1}{c|}{0.36}       & \multicolumn{1}{c|}{0.58}      & 1.67      \\ \hline
16                     & \multicolumn{1}{c|}{85\%}       & \multicolumn{1}{c|}{79\%}      & 68\%      & \multicolumn{1}{c|}{0.47}       & \multicolumn{1}{c|}{0.73}      & 1.67      \\ \hline
17                     & \multicolumn{1}{c|}{84\%}       & \multicolumn{1}{c|}{78\%}      & 70\%      & \multicolumn{1}{c|}{0.64}       & \multicolumn{1}{c|}{1.01}      & 1.96      \\ \hline
18                     & \multicolumn{1}{c|}{84\%}       & \multicolumn{1}{c|}{79\%}      & 70\%      & \multicolumn{1}{c|}{0.62}       & \multicolumn{1}{c|}{0.88}      & 1.80      \\ \hline
\end{tabular}


}

		
\caption{Testes realizados.}
\label{tab:tests_3}
		
\end{center}
\end{table}	







%%________________________________________________________________________
\section{Anotação e Melhoria do \textit{Dataset}}
\label{sec:resultadosnaapp}
%%________________________________________________________________________




%%________________________________________________________________________
\section{Modelo Final}
\label{sec:modelofinal}
%%________________________________________________________________________



%%________________________________________________________________________
\chapter{Conclusões e Trabalho Futuro}
\label{ch:conclusoesTrabalhoFuturo}
%%________________________________________________________________________

(Por fazer)


